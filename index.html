<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bet Buzz — Week 1</title>
<style>
  :root{
    --bg:#0b1020;--card:#121931;--text:#e8eefc;--muted:#a8b3cf;--accent:#7cc4ff;
    --ok:#8de38d;--warn:#ffd280;--err:#ff9aa2;--border:#233058;--elev:0 10px 30px rgba(0,0,0,.2);
    --gap:12px;--pill:#1a2447;
  }
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:15px/1.4 system-ui, -apple-system, Segoe UI, Roboto}
  header{padding:20px;display:flex;gap:14px;align-items:center;flex-wrap:wrap;border-bottom:1px solid var(--border)}
  h1{margin:0;font-size:20px;letter-spacing:.2px}
  .tag{background:var(--pill);color:var(--muted);padding:6px 10px;border-radius:999px;border:1px solid var(--border)}
  .wrap{max-width:1100px;margin:0 auto;padding:20px;display:grid;grid-template-columns:340px 1fr;gap:18px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;box-shadow:var(--elev)}
  .pad{padding:16px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  select,button,input{background:#0f1730;border:1px solid var(--border);color:var(--text);padding:10px 12px;border-radius:10px}
  button{cursor:pointer}
  .game{display:flex;justify-content:space-between;align-items:center;padding:14px 0;border-top:1px solid var(--border)}
  .game:first-child{border-top:0}
  .team{display:flex;flex-direction:column}
  .muted{color:var(--muted)}
  .big{font-size:28px;font-weight:700}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
  .kpi{padding:12px;border:1px dashed var(--border);border-radius:12px;background:#0e162c}
  .kpi .label{font-size:12px;color:var(--muted)}
  .kpi .val{font-size:18px;font-weight:700;margin-top:4px}
  .oddsRow{display:grid;grid-template-columns:140px repeat(3,1fr);gap:10px;align-items:center;border-top:1px solid var(--border);padding:10px 0}
  .oddsRow:first-child{border-top:0}
  .pill{padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#0f1730;display:inline-block}
  .good{background:rgba(141,227,141,.12);border-color:#234a23}
  .bad{background:rgba(255,154,162,.12);border-color:#4a2323}
  .neutral{background:rgba(124,196,255,.12);border-color:#234a4a}
  .tabs{display:flex;gap:8px;margin-top:8px}
  .tab{padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:#0f1730;color:var(--muted);cursor:pointer}
  .tab.active{color:var(--text);border-color:#365ca0;background:#14204a}
  .list{display:flex;flex-direction:column;gap:12px;margin-top:8px}
  .quote{padding:12px;border:1px solid var(--border);border-radius:12px;background:#0f1730}
  .src{font-size:12px;color:var(--muted)}
  .badge{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid var(--border);background:#0f1730;color:var(--muted)}
  .foot{padding:14px;border-top:1px solid var(--border);display:flex;justify-content:space-between;align-items:center}
  a{color:var(--accent);text-decoration:none}
  @media(max-width:980px){.wrap{grid-template-columns:1fr}}
</style>
</head>
<body>
<header>
  <h1>Bet Buzz</h1>
  <span class="tag">Week 1 • NCAA</span>
  <span class="tag">Experimental MVP</span>
</header>

<div class="wrap">

  <!-- Left: Game picker & filters -->
  <div class="card pad">
    <div class="row" style="justify-content:space-between;margin-bottom:10px">
      <div>
        <div class="muted" style="font-size:12px">Select a game</div>
        <select id="gameSelect"></select>
      </div>
      <div>
        <div class="muted" style="font-size:12px">Market</div>
        <div class="tabs">
          <div class="tab active" data-market="spread">Spread</div>
          <div class="tab" data-market="moneyline">Moneyline</div>
          <div class="tab" data-market="total">Total</div>
        </div>
      </div>
    </div>
    <div class="kpi">
      <div class="label">Consensus Edge (model)</div>
      <div class="val" id="edgeText">—</div>
      <div class="muted" id="edgeNote" style="font-size:12px;margin-top:6px">Based on average book vs. simple power rating.</div>
    </div>
    <div class="kpi" style="margin-top:12px">
      <div class="label">Public % (tickets / handle)</div>
      <div class="val" id="publicPct">—</div>
      <div class="muted" style="font-size:12px;margin-top:6px">Mocked splits; wire to a real feed later.</div>
    </div>
    <div class="kpi" style="margin-top:12px">
      <div class="label">Sentiment (last 24h)</div>
      <div class="val" id="sentiment">—</div>
      <div class="muted" style="font-size:12px;margin-top:6px">Weighted by source credibility.</div>
    </div>
  </div>

  <!-- Right: Game view -->
  <div class="card">
    <div class="pad" id="matchHeader">
      <!-- teams & line will render here -->
    </div>

    <div class="pad">
      <div class="grid">
        <div class="kpi">
          <div class="label">Best Line (you can get)</div>
          <div class="val" id="bestLine">—</div>
          <div class="muted" style="font-size:12px;margin-top:6px" id="bestLineBook">—</div>
        </div>
        <div class="kpi">
          <div class="label">Implied Probability</div>
          <div class="val" id="implied">—</div>
          <div class="muted" style="font-size:12px;margin-top:6px">For currently selected side/market.</div>
        </div>
        <div class="kpi">
          <div class="label">Quick EV (vs. model)</div>
          <div class="val" id="quickEV">—</div>
          <div class="muted" style="font-size:12px;margin-top:6px">Model win prob – implied prob.</div>
        </div>
      </div>
    </div>

    <div class="pad">
      <div class="muted" style="margin-bottom:8px">Lines across books</div>
      <div id="oddsTable"></div>
    </div>

    <div class="pad">
      <div class="row" style="justify-content:space-between">
        <div class="muted">What people are saying</div>
        <span class="badge" id="snippetCount">—</span>
      </div>
      <div class="list" id="snippets"></div>
    </div>

    <div class="foot">
      <div class="muted">Prototype • Mock data • Plug in real APIs next</div>
      <div class="row">
        <button id="flipSide">Flip Side</button>
        <button id="refresh">Refresh</button>
      </div>
    </div>
  </div>
</div>

<script>
/* -------------------- MOCK DATA (swap with real APIs) -------------------- */

const MOCK_GAMES = [
  { id:"osu-tex", kick:"2025-08-30T11:00:00-05:00", home:"Ohio State", away:"Texas", home_rank:3, away_rank:1, venue:"Ohio Stadium",
    power:{ // naive power ratings => model spread: home -2.0
      home: 92.5, away: 91.0
    }
  },
  { id:"clem-lsu", kick:"2025-08-30T18:30:00-05:00", home:"Clemson", away:"LSU", home_rank:4, away_rank:9, venue:"Memorial Stadium",
    power:{ home: 91.0, away: 90.0 }
  },
  { id:"neb-cin", kick:"2025-08-28T18:00:00-05:00", home:"Nebraska", away:"Cincinnati", venue:"Arrowhead (KC)",
    power:{ home: 84.0, away: 80.0 }
  },
  { id:"bsu-usf", kick:"2025-08-28T17:00:00-05:00", home:"USF", away:"Boise State", venue:"Raymond James",
    power:{ home: 80.5, away: 86.0 }
  }
];

const MOCK_ODDS = {
  // book keys: fd=FanDuel, dk=DraftKings, mg=MGM, pn=PointsBet (placeholders)
  "osu-tex": {
    spread: {
      side:"home", // default “our side”: home = OSU
      lines:[
        {book:"FD", home:-2.5, away:+2.5, price_home:-110, price_away:-110},
        {book:"DK", home:-2.0, away:+2.0, price_home:-115, price_away:-105},
        {book:"MGM",home:-3.0, away:+3.0, price_home:+100, price_away:-120}
      ]
    },
    moneyline:{
      side:"home",
      lines:[
        {book:"FD", home:-126, away:+105},
        {book:"DK", home:-130, away:+108},
        {book:"MGM",home:-120, away.+102}
      ]
    },
    total:{
      target:47.5,
      lines:[
        {book:"FD", over:47.5, under:47.5, price_over:-110, price_under:-110},
        {book:"DK", over:47.0, under:47.0, price_over:-115, price_under:-105},
        {book:"MGM",over:48.0, under:48.0, price_over:+100, price_under:-120}
      ]
    },
    public:{ // pretend splits
      spread:{tickets_home:53, handle_home:58},
      ml:{tickets_home:51, handle_home:55},
      total:{tickets_over:48, handle_over:46}
    },
    sentiment:{
      score:+0.18, // -1..+1
      snippets:[
        {src:"Reddit r/CFB", text:"OSU front seven vs Texas OL is the real mismatch.", score:+0.4},
        {src:"X @SharpCFB", text:"If DK hangs -2 flat, I’m grabbing OSU. Under also live.", score:+0.2},
        {src:"Blog", text:"Arch can stress OSU downfield; live Over if tempo pops.", score:-0.1}
      ]
    }
  },
  "clem-lsu":{
    spread:{
      side:"home",
      lines:[
        {book:"FD", home:-3.5, away:+3.5, price_home:-110, price_away:-110},
        {book:"DK", home:-3.0, away:+3.0, price_home:-120, price_away:+100},
        {book:"MGM",home:-4.0, away:+4.0, price_home:+100, price_away:-120}
      ]
    },
    moneyline:{
      side:"home",
      lines:[
        {book:"FD", home:-180, away:+150},
        {book:"DK", home:-175, away:+155},
        {book:"MGM",home:-185, away:+145}
      ]
    },
   total:{
      target:57.5,
      lines:[
        {book:"FD", over:57.5, under:57.5, price_over:-110, price_under:-110},
        {book:"DK", over:57.0, under:57.0, price_over:-115, price_under:-105},
        {book:"MGM",over:58.0, under:58.0, price_over:+100, price_under:-120}
      ]
    },
    public:{
      spread:{tickets_home:56, handle_home:60},
      ml:{tickets_home:58, handle_home:62},
      total:{tickets_over:61, handle_over:64}
    },
    sentiment:{
      score:+0.05,
      snippets:[
        {src:"Covers forum", text:"Feels like Clemson by a FG exactly—buy the -3", score:+0.1},
        {src:"X @ModelGuy", text:"My sim makes this Clemson -0.8, small LSU +4 value", score:-0.1},
        {src:"Podcast", text:"Lean under unless LSU tempo shows up early.", score:+0.0}
      ]
    }
  },
  "neb-cin":{
    spread:{
      side:"home",
      lines:[
        {book:"FD", home:-6.5, away:+6.5, price_home:-110, price_away:-110},
        {book:"DK", home:-7.0, away:+7.0, price_home:+100, price_away:-120}
      ]
    },
    moneyline:{
      side:"home",
      lines:[
        {book:"FD", home:-235, away:+190},
        {book:"DK", home:-240, away:+195}
      ]
    },
    total:{
      target:54.5,
      lines:[
        {book:"FD", over:54.5, under:54.5, price_over:-110, price_under:-110}
      ]
    },
    public:{ spread:{tickets_home:59, handle_home:63}, ml:{tickets_home:62, handle_home:68}, total:{tickets_over:49, handle_over:47}},
    sentiment:{ score:+0.22, snippets:[
      {src:"Discord", text:"Arrowhead crowd will feel 70% Huskers.", score:+0.3}
    ]}
  },
  "bsu-usf":{
    spread:{
      side:"away", // we’ll default to Boise (away) here
      lines:[
        {book:"FD", home:+5.5, away:-5.5, price_home:-110, price_away:-110},
        {book:"DK", home:+6.0, away:-6.0, price_home:-115, price_away:-105}
      ]
    },
    moneyline:{
      side:"away",
      lines:[
        {book:"FD", home:+185, away:-220},
        {book:"DK", home:+195, away:-230}
      ]
    },
    total:{
      target:62.5,
      lines:[
        {book:"FD", over:62.5, under:62.5, price_over:-110, price_under:-110},
        {book:"DK", over:63.5, under:63.5, price_over:+100, price_under:-120}
      ]
    },
    public:{ spread:{tickets_home:44, handle_home:40}, ml:{tickets_home:42, handle_home:38}, total:{tickets_over:58, handle_over:61}},
    sentiment:{ score:-0.06, snippets:[
      {src:"Blog", text:"Bulls offense can run; doubt they stop Boise late.", score:+0.2},
      {src:"Forum", text:"Too many points? Lean USF +6 if it climbs.", score:-0.3}
    ]}
  }
};

/* -------------------- HELPERS -------------------- */

const $ = sel => document.querySelector(sel);

function moneylineToImplied(ml){
  if(ml===0) return 0.5;
  if(ml>0) return 100/(ml+100);
  return -ml/(-ml+100);
}
function formatPct(x){return (x*100).toFixed(1)+"%";}
function fmtPrice(p){return p>0?`+${p}`:`${p}`;}
function bestLineML(lines, side){
  // side: 'home' or 'away'. For fav take the most negative (closest to 0); for dog take the highest +.
  if(side==='home'){
    // pick line with highest implied value (least negative)
    return lines.reduce((best,l)=>{
      const v = l.home;
      if(!best) return l;
      const cur = best.home;
      // e.g. -120 is better than -180; + values never occur for favs but guard anyway
      const better = (v>0 && cur<0) || (v>cur && v<=0) || (v>cur && cur>0);
      return better? l: best;
    },null);
  } else {
    return lines.reduce((best,l)=>{
      const v = l.away;
      if(!best) return l;
      const cur = best.away;
      const better = (v>cur);
      return better? l: best;
    },null);
  }
}
function averageSpreadNumber(lines){
  // return avg home spread (negative = home favored)
  const nums = lines.map(l=>l.home);
  return nums.reduce((a,b)=>a+b,0)/nums.length;
}
function simpleModelSpread(powerHome, powerAway){
  // naive: (home - away) + 1.5 HFA
  return (powerHome - powerAway) + 1.5;
}
function quickEV(modelProb, impliedProb){
  const ev = modelProb - impliedProb; // positive = edge
  return (ev>=0? "+" : "") + (ev*100).toFixed(1) + " pts";
}
function signClass(val){ return val>0.05? "good" : val<-0.05? "bad" : "neutral"; }

/* -------------------- STATE -------------------- */

let state = {
  market:"spread",
  gameId: MOCK_GAMES[0].id,
  // selected side (for spread/ml): 'home' or 'away'
  side:null
};

/* -------------------- RENDER -------------------- */

function renderGameOptions(){
  const sel = $("#gameSelect");
  sel.innerHTML = MOCK_GAMES.map(g=>{
    const tagH = g.home_rank? ` (#${g.home_rank})`:"";
    const tagA = g.away_rank? ` (#${g.away_rank})`:"";
    return `<option value="${g.id}">${g.away}${tagA} @ ${g.home}${tagH}</option>`;
  }).join("");
  sel.value = state.gameId;
}

function renderTabs(){
  document.querySelectorAll(".tab").forEach(tab=>{
    tab.classList.toggle("active", tab.dataset.market===state.market);
  });
}

function renderHeader(){
  const g = MOCK_GAMES.find(x=>x.id===state.gameId);
  const odds = MOCK_ODDS[state.gameId];
  const m = state.market;
  const side = (state.side) || (m==="total"? "over" : odds[m].side);

  // header
  const lineAvg = m==="spread" ? averageSpreadNumber(odds.spread.lines).toFixed(1)
                : m==="moneyline" ? "—"
                : odds.total.target.toFixed(1);

  $("#matchHeader").innerHTML = `
    <div class="row" style="justify-content:space-between">
      <div class="team">
        <div class="muted">${new Date(g.kick).toLocaleString()}</div>
        <div class="big">${g.away}${g.away_rank? ` (#${g.away_rank})`:""} @ ${g.home}${g.home_rank? ` (#${g.home_rank})`:""}</div>
        <div class="muted">${g.venue}</div>
      </div>
      <div class="row">
        <span class="pill">Market: <b style="margin-left:6px">${m}</b></span>
        <span class="pill">Avg Line: <b style="margin-left:6px">${lineAvg}</b></span>
        <span class="pill">Side: <b style="margin-left:6px" id="sideLabel">${side.toUpperCase()}</b></span>
      </div>
    </div>
  `;

  // edge calc (super simple for MVP)
  let edgeTxt="—", edgeNote="—";
  if(m==="spread"){
    const model = simpleModelSpread(g.power.home, g.power.away); // home negative means fav by abs? (we show as home -x).
    const avg = averageSpreadNumber(odds.spread.lines);
    const diff = model - avg; // positive: model says bigger home edge than market
    edgeTxt = (diff>=0? "+" : "") + diff.toFixed(1) + " pts vs market";
    edgeNote = `Model (home ${model.toFixed(1)}) vs market avg (${avg.toFixed(1)}).`;
  } else if(m==="moneyline"){
    const mlBest = bestLineML(odds.moneyline.lines, side);
    const price = side==='home'? mlBest.home : mlBest.away;
    // fake model prob via powers:
    const pHome = 1/(1+Math.pow(10, ((g.power.away - g.power.home - 1.5)/6)));
    const modelProb = side==='home'? pHome : (1-pHome);
    const implied = moneylineToImplied(price);
    edgeTxt = quickEV(modelProb, implied);
    edgeNote = `Model win ${formatPct(modelProb)} vs implied ${formatPct(implied)} @ ${mlBest.book} ${fmtPrice(price)}.`;
  } else {
    edgeTxt = "Watch splits & tempo (mocked)";
    edgeNote = `Market total ${odds.total.target.toFixed(1)}; adjust for pace/in-game.`;
  }
  $("#edgeText").textContent = edgeTxt;
  $("#edgeNote").textContent = edgeNote;

  // public % + sentiment
  const pub = odds.public;
  $("#publicPct").textContent = (m==="spread")
    ? `${pub.spread.tickets_home}% tix / ${pub.spread.handle_home}% $ on HOME`
    : (m==="moneyline")
      ? `${pub.ml.tickets_home}% tix / ${pub.ml.handle_home}% $ on HOME`
      : `${pub.total.tickets_over}% tix / ${pub.total.handle_over}% $ on OVER`;

  const s = odds.sentiment;
  $("#sentiment").innerHTML = `<span class="pill ${signClass(s.score)}">Score ${ (s.score>=0? "+" :"") + s.score.toFixed(2) }</span>`;

  // kpis: best line, implied, EV
  if(m==="moneyline"){
    const best = bestLineML(odds.moneyline.lines, side);
    const price = side==='home'? best.home : best.away;
    $("#bestLine").textContent = fmtPrice(price);
    $("#bestLineBook").textContent = `${best.book} • Best ${side.toUpperCase()} ML`;
    const imp = moneylineToImplied(price);
    $("#implied").textContent = formatPct(imp);
    // Same model prob as above
    const pHome = 1/(1+Math.pow(10, ((g.power.away - g.power.home - 1.5)/6)));
    const modelProb = side==='home'? pHome : (1-pHome);
    $("#quickEV").textContent = quickEV(modelProb, imp);
  } else if(m==="spread"){
    const avg = averageSpreadNumber(odds.spread.lines);
    $("#bestLine").textContent = `${avg>0? "HOME" : "HOME"} ${avg.toFixed(1)}`;
    $("#bestLineBook").textContent = `Avg across books`;
    $("#implied").textContent = "—";
    $("#quickEV").textContent = "—";
  } else {
    const tgt = odds.total.target;
    $("#bestLine").textContent = tgt.toFixed(1);
    $("#bestLineBook").textContent = `Consensus total`;
    $("#implied").textContent = "—";
    $("#quickEV").textContent = "—";
  }

  // odds table
  const tbl = [];
  if(m==="spread"){
    tbl.push(rowHeader(["Book","Home","Away","Note"]));
    odds.spread.lines.forEach(l=>{
      tbl.push(oddsRow(l.book, `${l.home>0? "+" : ""}${l.home} (${fmtPrice(l.price_home)})`, `${l.away>0? "+" : ""}${l.away} (${fmtPrice(l.price_away)})`, "—"));
    });
  } else if(m==="moneyline"){
    tbl.push(rowHeader(["Book","Home ML","Away ML","Implied (sel)"]));
    const sideSel = (state.side)||(odds.moneyline.side);
    odds.moneyline.lines.forEach(l=>{
      const price = sideSel==='home'? l.home : l.away;
      tbl.push(oddsRow(l.book, fmtPrice(l.home), fmtPrice(l.away), formatPct(moneylineToImplied(price))));
    });
  } else {
    tbl.push(rowHeader(["Book","Over","Under","Note"]));
    odds.total.lines.forEach(l=>{
      tbl.push(oddsRow(l.book, `${l.over} (${fmtPrice(l.price_over)})`, `${l.under} (${fmtPrice(l.price_under)})`, "—"));
    });
  }
  $("#oddsTable").innerHTML = tbl.join("");

  // snippets
  const list = odds.sentiment.snippets.map(q=>`
    <div class="quote">
      <div>${q.text}</div>
      <div class="row" style="margin-top:6px;justify-content:space-between">
        <span class="src">${q.src}</span>
        <span class="badge ${signClass(q.score)}">${q.score>=0? "+" : ""}${q.score.toFixed(2)}</span>
      </div>
    </div>
  `).join("");
  $("#snippets").innerHTML = list;
  $("#snippetCount").textContent = `${odds.sentiment.snippets.length} notes`;
}

function rowHeader(cols){
  return `<div class="oddsRow muted">${cols.map(c=>`<div>${c}</div>`).join("")}</div>`;
}
function oddsRow(book,c1,c2,c3){
  return `<div class="oddsRow">
    <div><b>${book}</b></div>
    <div>${c1}</div>
    <div>${c2}</div>
    <div class="muted">${c3}</div>
  </div>`;
}

/* -------------------- EVENTS -------------------- */

function wire(){
  $("#gameSelect").addEventListener("change", e=>{
    state.gameId = e.target.value;
    state.side = null;
    renderAll();
  });
  document.querySelectorAll(".tab").forEach(tab=>{
    tab.addEventListener("click", ()=>{
      state.market = tab.dataset.market;
      state.side = null;
      renderAll();
    });
  });
  $("#flipSide").addEventListener("click", ()=>{
    if(state.market==="total"){
      // toggle O/U visualization later if you want
      return;
    }
    const o = MOCK_ODDS[state.gameId][state.market];
    const cur = state.side || o.side || "home";
    state.side = (cur==="home" ? "away":"home");
    $("#sideLabel").textContent = state.side.toUpperCase();
    renderHeader();
  });
  $("#refresh").addEventListener("click", ()=>{
    // in real app: re-fetch odds + sentiment
    renderAll();
  });
}

function renderAll(){
  renderTabs();
  renderHeader();
}

renderGameOptions();
wire();
renderAll();
</script>
</body>
</html>
